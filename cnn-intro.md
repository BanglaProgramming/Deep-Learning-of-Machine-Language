## সহজ উদাহরণ  
চলুন আমরা একটা জগতের কথা চিন্তা করি যে জগতে একটা কম্পিউটার আছে যার ডিসপ্লে মাত্র<span class="s1"> 2x2 </span>পিক্সেল সাইজের। আর ওই জগতে সব মিলে ২টা ক্যারেক্টার বা বর্ণ আছে যেগুলো হচ্ছে<span class="s1">, \ </span>এবং<span class="s1"> / </span>অর্থাৎ ওখানকার কিবোর্ড দিয়ে একটা ফরওয়ার্ড স্ল্যাস অথবা একটা ব্যাক স্ল্যাস লেখা যায়<span class="s1"> :P </span>অনেকটা নিচের মত<span class="s1"> -</span></p>
<p class="p1"><img class="aligncenter wp-image-1731" src="https://nuhil.files.wordpress.com/2017/05/screen-shot-2017-05-20-at-8-51-18-pm.png" alt="" width="365" height="181" /></p>
<p class="p1">এখন আমরা এই কম্পিউটারের জন্য একটা ইমেজ ক্লাসিফায়ার সফটওয়্যার বানাতে চাই যাতে করে যখন আমরা কম্পিউটারকে নিচের ইমেজটি ইনপুট দেবো তখন সে যাতে সেটা চিনে বলতে পারে যে এটা একটা<span class="s1"> \. (</span>ব্যাক স্ল্যাস<span class="s1">)</span></p>
<p class="p1"><img class="aligncenter wp-image-1732" src="https://nuhil.files.wordpress.com/2017/05/screen-shot-2017-05-20-at-8-52-13-pm.png" alt="" width="328" height="156" /></p>
<p class="p1">এবং একই ভাবে ফরওয়ার্ড স্ল্যাসটাকেও চিনতে পারে।</p>
<p class="p1">কিন্তু আমরা সবাই জানি যে কম্পিউটারের কাছে সব কিছুই আসলে নাম্বার। কম্পিউটার তো আর সরাসরি ফটো চেনে না<span class="s1">, </span>খুব বেশি হলে একটা ফটোর ম্যাথেমেটিক্যাল রিপ্রেজেন্টেশন চেনে। তাই<span class="s1">, </span>ধরে নিচ্ছি যে সেই কম্পিউটারের গ্রাফিক্স প্রোগ্রামটি মনিটরে কোন অ্যাক্টিভ পিক্সেল বা রং<span class="s1"> (</span>এক্ষেত্রে ধরি লাল রঙের মান<span class="s1"> 1) </span>দেখানোর জন্য<span class="s1"> 1 </span>ব্যবহার করে এবং রং এর অনুপস্থিতি<span class="s1"> (</span>ধরি গ্রে কালার এর মান<span class="s1"> -1) </span>প্রকাশের জন্য<span class="s1"> -1 </span>ব্যবহার করে।এতে করে প্রত্যেকটি বর্ণের গ্রাফিক্যাল রিপ্রেজেন্টেশন নিচের মত ধরে নেয়া যেতে পারে।</p>
<p class="p1"><img class="aligncenter wp-image-1733" src="https://nuhil.files.wordpress.com/2017/05/screen-shot-2017-05-20-at-8-53-34-pm.png" alt="" width="109" height="176" /></p>
<p class="p1">কিন্তু গ্রাফিক্যাল রিপ্রেজেন্টেশন বা ম্যাথেম্যাটিক্যাল রিপ্রেজেন্টেশন যাই হোক কম্পিউটার এই ম্যাট্রিক্সের মত দেখতে ডাটা ফরম্যাটকে লম্বা একটা অ্যারের মত করেই ধরে<span class="s1">, </span>হিসাব নিকাশ করার জন্য। অর্থাৎ নিচের মত<span class="s1">,</span></p>
<p class="p1"><img class="aligncenter wp-image-1734" src="https://nuhil.files.wordpress.com/2017/05/screen-shot-2017-05-20-at-8-54-38-pm.png?w=687" alt="" width="333" height="177" /></p>
<p class="p1">পাইছি এবার। খেয়াল করুন এই দুটা আলাদা ইমেজের জন্য যে ফাইনাল ডাটা স্ট্রাকচার দাঁড়ালো সেগুলোকে কিন্তু আমরা আমাদের সেই প্রথম দিকের ইনপুট কম্বিনেশন সমস্যার সাথেই তুলনা করতে পারি। অর্থাৎ<span class="s1"> 1 -1 -1 1 </span>কম্বিনেশনের আউটপুট ধরি<span class="s1"> 1 (</span>ধরি<span class="s1"> 1 </span>মানে ব্যাক স্ল্যাস<span class="s1">) </span>আর<span class="s1"> -1 1 1 -1 </span>কম্বিনেশনের আউটপুট ধরি<span class="s1"> 0 (</span>ধরি<span class="s1"> 0 </span>মানে ফরওয়ার্ড স্ল্যাস<span class="s1">)</span>।</p>
<p class="p1">তাহলে যদি আমরা এই ইনপুট কম্বিনেশন গুলোতে সঠিক ভাবে কিছু ওয়েট সেট করতে পারি এবং দুইটা আলাদা ইনপুট কম্বিনেশনের জন্য দুটো আলাদা রেজাল্ট আসে<span class="s1"> (</span>একটা শূন্যের কাছা কাছি আরেকটা এক এর কাছাকাছি। তাহলেই কিন্তু আমাদের ইমেজ ক্লাসিফায়ার তৈরি হয়ে গেলো। ওই ক্লাসিফায়ারে যতবারই<span class="s1"> [1 -1 -1 1] </span>তথা ব্যাক স্ল্যাসের ইমেজের একটি ডাটা ম্যাট্রিক্স দেয়া হবে ততবার সে ওই ইনপুট গুলোর সাথে ওয়েট এর গুন যোগ করে আউটপুট দিবে ১ এর কাছাকাছি একটা মান আর আমরা জানি ১ মানে ব্যাক স্ল্যাস। তাই চিনে যাবো এই ইমেজ একটা ব্যাক স্ল্যাস। তো<span class="s1">, </span>চলুন এই সিম্পল ক্লাসিফায়ারের জন্য কিছু অপ্টিমাইজড ওয়েট বের করি।</p>
<p class="p1">প্রথমেই সব ওয়েট মনে করি<span class="s1"> 1. </span>তাহলে<span class="s1"> [1 -1 -1 1] </span>এর জন্য<span class="s1"> - </span></p>
<p class="p3">(1*1) + (-1*1) + (-1*1) + (1*1) = 1 - 1 - 1 + 1 = 0</p>
<p class="p3"><span class="s2">আর</span> [-1 1 1 -1] <span class="s2">এর</span> <span class="s2">জন্য</span> -</p>
<p class="p3">(-1*1)+(1*1)+(1*1)*(-1*1) = -1 + 1 + 1 - 1 = 0</p>
<p class="p1">লাভ হল না<span class="s1">, </span>দুইটার ক্ষেত্রেই শূন্য আসছে অর্থার ক্লাসিফাই করার মত সলিড<span class="s1"> Rule </span>এটা হয় নি বা বলা যায় ওয়েট গুলো সঠিক হয় নি। ওয়েট গুলো একটু অ্যাডজাস্ট করে নিচের মত ট্রাই করি। অর্থাৎ প্রথম এইজের ওয়েট ধরি<span class="s1"> 1, </span>দ্বিতীয় এইজের ওয়েট ধরি<span class="s1"> -1, </span>তৃতীয় এইজের ওয়েট ধরি<span class="s1"> -1 </span>এবং চতুর্থ এইজের ওয়েট ধরি<span class="s1"> 1. (</span>যেহেতু চারটা<span class="s1"> Edge </span>ধরে ৪টা ইনপুট আসছে একটা নিউরনের দিকে<span class="s1">)</span></p>
<p class="p3"><span class="s2">তাহলে</span> [1 -1 -1 1] <span class="s2">এর</span> <span class="s2">জন্য</span> -</p>
<p class="p3">(1*1) + (-1*-1) + (-1*-1) + (1*1) = 1 + 1 + 1 + 1 = 4 Sigmoid <span class="s2">করে</span> 0.98</p>
<p class="p3"><span class="s2">আর</span> [-1 1 1 -1] <span class="s2">এর</span> <span class="s2">জন্য</span> -</p>
<p class="p3">(-1*1)+(1*-1)+(1*-1)*(-1*1) = -1 - 1 - 1 - 1 = -4 Sigmoid <span class="s2">করে</span> 0.01</p>
<p class="p1">অর্থাৎ আমরা মোটামুটি সঠিক ওয়েট এর খোঁজ পেয়েছি যেগুলো একটি ব্যাসিক নিউরাল নেটওয়ার্কে ব্যবহার করলে দুটা আলাদা ইনপুট কম্বিনেশনের জন্য দুটো আলাদা আউটপুট আসে এবং তার সাহায্যে আমরা দুটো ইমেজকে ক্লাসিফাই বা আলাদা করে চিনতে পারি<span class="s1"> :D </span>একটু পরীক্ষা করেও দেখতে পারেন যে আসলেই সঠিক ওয়েটের খোঁজ পাওয়া গেছে কিনা। যেমন<span class="s1"> - </span>নিচের দুটো ইমেজের কথা চিন্তা করুন<span class="s1">,</span></p>
<p class="p1"><img class="aligncenter wp-image-1735" src="https://nuhil.files.wordpress.com/2017/05/screen-shot-2017-05-20-at-8-56-00-pm.png" alt="" width="118" height="239" /></p>
<p class="p1">দেখে মনে হচ্ছে উপরের ইমেজটি একটি ব্যাক স্ল্যাস কিন্তু উপড়ে একটু কালি বেশি পরে গেছে। আর নিচেরটা একটা ফরওয়ার্ড স্ল্যাস কিন্তু উপড়ে পুরোটা আকা শেষ হয়নি। এটা আমরা ধারনা করতে পারছি। কিন্তু চলুন পরীক্ষা করে দেখি আমাদের একটু আগের ব্যাসিক ইমেজ ক্লাসিফায়ার নিউরাল নেটওয়ার্ক এটা ধরতে পারে কিনা।</p>
<p class="p1">তাহলে প্রথম ইমেজ অর্থাৎ<span class="s1"> [1 1 -1 1] </span>এর জন্য<span class="s1"> - </span></p>
<p class="p3">(1*1) + (1*-1) + (-1*-1) + (1*1) = 1 - 1 + 1 + 1 = 2 Sigmoid <span class="s2">করে</span> 0.88 (1 <span class="s2">এর</span> <span class="s2">কাছাকাছি</span> <span class="s2">অর্থাৎ</span> <span class="s2">ব্যাক</span> <span class="s2">স্ল্যাস</span>)</p>
<p class="p3"><span class="s2">আর</span> [-1 -1 1 -1] <span class="s2">এর</span> <span class="s2">জন্য</span> -</p>
<p class="p3">(-1*1)+(-1*-1)+(1*-1)*(-1*1) = -1 + 1 - 1 - 1 = -2 Sigmoid <span class="s2">করে</span> 0.11 (0 <span class="s2">এর</span> <span class="s2">কাছাকাছি</span> <span class="s2">অর্থাৎ</span> <span class="s2">ফরওয়ার্ড</span> <span class="s2">ল্যাস</span>)</p>
<p class="p1">গ্রেট<span class="s1">, </span>এরকম ভাঙ্গা হাতের লেখাকেও আমাদের ক্লাসিফায়ার ঠিকি ধরতে পারছে<span class="s1"> :) </span>কিন্তু ভুলে গেলে চলবে না<span class="s1">, </span>এই যে<span class="s1">, </span>হুট করে সব ওয়েট<span class="s1"> [1 1 1 1] </span>এর কথা চিন্তা করে তারপর অপ্টিমাইজড ওয়েট<span class="s1"> [1 -1 -1 1] -</span>এ আসতে পারা<span class="s1">, </span>এখানে কিন্তু সেই এরর<span class="s1">, </span>অ্যাডজাস্ট<span class="s1">, </span>লার্নিং লুপেরই কাজ করতে হবে। এসব আগেই আলোচনা হয়ে গেছে<span class="s1"> :) </span>আমরা বোঝার জন্য এক লাফেই অপ্টাইজ ওয়েট নিয়ে পরীক্ষা করেছি।<span class="s1"> </span></p>
<p class="p1">এবার চলুন একটু জটিল আরেকটা জগতের কথা চিন্তা করি যে জগতে একটা কম্পিউটার আছে যার ডিসপ্লে<span class="s1"> 3x3 </span>পিক্সেল সাইজের। আর ওই জগতে সব মিলে ৪টা ক্যারেক্টার বা বর্ণ আছে যেগুলো হচ্ছে<span class="s1"> - \ / X O </span>অর্থাৎ ওখানকার কিবোর্ড দিয়ে একটা ফরওয়ার্ড স্ল্যাস<span class="s1">, </span>একটা ব্যাক স্ল্যাস<span class="s1">, </span>একটা এক্স<span class="s1">, </span>আরেকটা ও লেখা যায়<span class="s1"> :P </span>অনেকটা নিচের মত<span class="s1"> -</span></p>
<p class="p1"><img class="aligncenter wp-image-1736" src="https://nuhil.files.wordpress.com/2017/05/screen-shot-2017-05-20-at-8-57-42-pm.png" alt="" width="336" height="169" /></p>
<p class="p1">এখন মনে করুন যে ওই ৪টি বর্ণের কোন একটিকে কম্পিউটারে টাইপ করলে এর মনিটরে নিচের মত করে সেই ক্যারেক্টারটি রেন্ডার হয়<span class="s1"> -</span></p>
<p class="p1"><img class="aligncenter wp-image-1737" src="https://nuhil.files.wordpress.com/2017/05/screen-shot-2017-05-20-at-8-58-28-pm.png" alt="" width="286" height="181" /></p>
<p class="p1">এখন প্রশ্ন হচ্ছে কিভাবে আমরা তুলনামূলক জটিল একটি ক্লাসিফায়ার বানাতে পারি যার মাধ্যমে আমরা এই ক্যারেক্টার গুলোকে শুধুমাত্র তাদের ডাটা দেখে আলাদা করে চিনতে পারি<span class="s1">? </span>এখানে কিন্তু সেই ব্যাসিক ক্লাসিফায়ার কাজ করবে না। কেন করবে না সেটা এই পোস্টের দ্বিতীয় উদাহরণ পড়লেও আন্দাজ পাওয়া যাবে। এমনকি খুব সময় দিয়ে ওয়েট অ্যাডজাস্ট করে করেও এর জন্য পারফেক্ট কোন ওয়েট ম্যাট্রিক্স পাওয়া যাবে না যাতে করে ক্লাসিফায়ারটি খুব অ্যাকিউরেট হয়। কারন<span class="s1"> - </span>বাস্তবে একটা বর্ণ একটা ইমেজের একদম মাঝেখানেই যে থাকবে তা নয়। বর্ণ একটাই যদি ধরি<span class="s1"> X. </span>সেটা এক একটা ইমেজে এক এক ভাবে থাকতে পারে। যেমন<span class="s1"> - </span>কোন ফটোতে একটু ডানে চাপিয়ে<span class="s1">, </span>কোনটাতে একটু বাপে চেপে অথবা কোথাও একটু ছোট<span class="s1"> (</span>কম পিক্সেল ডাইমেনশন নিয়ে<span class="s1">), </span>অথবা কোথাও বড় আকারে থাকতে পারে। তাই পিক্সেল গুলোর সাথে যতই পারেফেক্ট ওয়েট জুড়ে দেয়া হোক না কেন<span class="s1">,  </span>অবস্থা বিশেষে ক্লাসিফায়ার চিনতে পারবে না যে সেই ফটোতে নির্দিষ্ট একটা বর্ণ আছে।</p>
<p class="p1">তো উপায় যেটা সেটা হচ্ছে<span class="s1">, </span>একটা<span class="s1"> X </span>দেখতে কেমন এবং তার বিভিন্ন অংশ গুলো কেমন সেগুলোকে প্রথমে চিনে তারপর অংশ ভিত্তিক কম্বিনেশন খুঁজতে হবে সেই বড় ইমেজটাতে<span class="s1"> (</span>যেটায়<span class="s1"> X </span>লুকায় আছে<span class="s1">)</span>। পিক্সেল ভিত্তিক খোঁজে আর কাজ হবে না। এতে করে<span class="s1"> X </span>বর্ণটা ইমেজের যেখানেই থাকুক আর যেভাবেই থাকুক না কেন<span class="s1">, </span>তার অংশ বিশেষগুলো কিন্তু যেখানে থাকবে একভাবে থাকবে। অর্থাৎ<span class="s1"> X </span>এর হাত গুলো কিন্তু ছিন্ন বিচ্ছিন্ন হয়ে থাকবে না। যেখানেই থাকুক না কেন হাত গুলো জয়েন্ট আকারেই থাকবে। তেমনি<span class="s1"> O </span>যেখানেই যেভাবে থাকুক<span class="s1">,  </span>মাঝখানে একটা ফাকা জায়গা থাকবে এটা স্বাভাবিক।</p>
<p class="p1">আচ্ছা<span class="s1">, </span>এবার আমরা একটু<span class="s1"> 2x2 </span>পিক্সেলের জগত থেকে হেল্প নেবো। সেখানে আমাদের ব্যাক এবং ফরওয়ার্ড স্ল্যাস আছে। খেয়াল করুন<span class="s1">, </span>সেগুলাই কিন্তু<span class="s1"> X </span>এর হাত গুলোর মতই। অর্থাৎ একভাবে খেয়াল করলে বলা যায় যে<span class="s1"> - </span>তিন পিক্সেল ওয়ালা জগতের<span class="s1"> X, O, \, /<span class="Apple-converted-space">  </span></span>গুলো বস্তুত দুই পিক্সেল ওয়ালা জগতের<span class="s1"> \ </span>এবং<span class="s1"> / </span>এর সমন্বয়েই তৈরি। নিচের ফিগারটা একটু খেয়াল করি<span class="s1">,</span></p>
<p class="p1"><img class="aligncenter wp-image-1738" src="https://nuhil.files.wordpress.com/2017/05/screen-shot-2017-05-20-at-8-59-46-pm.png?w=687" alt="" width="459" height="259" /></p>
<p class="p1">উপরের ডায়ারগ্রামটাই কিন্তু একটা কনভলিউশনাল নিউরাল নেটওয়ার্কের ব্লক ডায়াগ্রাম।<span class="s1"> (</span>ভয়ের কিছু নাই বিস্তারিত এড়িয়ে যাওয়া হবে না<span class="s1">)</span>। দুটি স্টেজে একটা কনভলিউশনাল নিউরাল নেটওয়ার্কের কাজকে বর্ণনা করা যায়। প্রথম স্টেজে অর্থাৎ বামের দিকে একটি বড় ইমেজ থেকে<span class="s1"> Convolution </span>এবং<span class="s1"> Pooling </span>টেকনিকের মাধ্যমে ছোট কিন্তু অর্থবহ ইমেজ বের করে আনা হয়।<span class="s1"> Convolution </span>এর জন্য ছোট ইমেজ ব্যবহার করা হয় যেটাকে ফিল্টার বলা হয়। যেমন<span class="s1"> X </span>ওয়ালা বড় একটা ইমেজের উপর আমরা<span class="s1"> \ </span>এর ইমেজ এবং<span class="s1"> / </span>এর ইমেজ নিয়ে<span class="s1"> Convolution </span>করতে পারি কারণ পুরো<span class="s1"> X </span>এর মধ্যে বস্তুত এগুলোরই অবস্থান। আর তাই<span class="s1"> X </span>এর হাত গুলোকে চিনে নেয়ার জন্য আমরা শুধু<span class="s1"> (</span>কাটা<span class="s1">) </span>হাতের ফটোকে ফিল্টার হিসেবে ব্যবহার করতে পারি।<span class="s1"> </span></p>
<p class="p1">এরপর সেই ছোট আকারের ইমেজ গুলোকে নিয়ে পরের স্টেজে নিউরাল নেটওয়ার্ক এর কাজ করা হয়। এই স্টেজে নিউরাল নেটওয়ার্কের লজিক<span class="s1">, </span>ওয়েট ইত্যাদি ফিক্স করে<span class="s1">, </span>এর আগের স্টেজের ইমেজ অর্থাৎ<span class="s1"> Pooled </span>ইমেজের উপর কাজ করা হয় এবং পিক্সেল কম্বিনেশন যাচাই করে পার্থক্য বা চেনার কাজ করা হয়। এই দ্বিতীয় স্টেজটাকে বলে<span class="s1"> Fully Connected Layer </span>আর প্রথম স্টেজকে বলে<span class="s1"> Convolution Layer (</span>এই স্টেজে পুলিং বা অন্যান্য আরও কিছু ফাংশনের ব্যবহার থাকতে পারে<span class="s1">)</span>।</p>
<p class="p1">একটু বিস্তারিতভাবে এবার এই কাজ গুলো করে দেখি। নিচের ফিগারটি খেয়াল করুন<span class="s1">,</span></p>
<p class="p1"><img class="aligncenter wp-image-1739" src="https://nuhil.files.wordpress.com/2017/05/screen-shot-2017-05-20-at-9-00-38-pm.png?w=687" alt="" width="467" height="217" /></p>
<p class="p1">এখানে বাম পাশে একটা<span class="s1"> X </span>ওয়ালা ইমেজ আছে। তার ডানে আমরা দুটো ফিল্টার নিয়েছি। একটা ফিল্টার আসলে ব্যাক স্ল্যাস চেনার ফিল্টার। এই ফিল্টার দিয়ে বড় ইমেজের উপর ঘুরে বেড়ালে<span class="s1"> (Convolution </span>করলে<span class="s1">) </span>যেখানেই হাই ভ্যালু পাবে সেখানেই একটা ব্যাক স্ল্যাস পাওয়া গেছে বলে ধরে নেয়া যাবে। আগের মত চিন্তা করলে এটা ব্যাক স্ল্যাস চেনার সেই ওয়েট ম্যাট্রিক্স। শুধু<span class="s1"> +1 </span>আর<span class="s1"> -1 </span>কে<span class="s1"> + </span>এবং<span class="s1"> - </span>এ চিহ্নিত করা হয়েছে<span class="s1"> (</span>অর্থাৎ<span class="s1"> [1 -1 -1 1] =&gt; [+ - - +].<span class="Apple-converted-space">   </span></span>আরেকটা ফিল্টার হচ্ছে ফরওয়ার্ড স্ল্যাস চেনার ফিল্টার। এই ফিল্টারকে বড় ইমেজের উপড়ে ঘুরিয়ে নিয়ে বেড়ালে যখনই হাই ভ্যালু পাবে তখন সেখানে একটা ফরওয়ার্ড স্ল্যাস আছে বলে জানা যাবে।</p>